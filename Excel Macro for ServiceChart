Private Declare PtrSafe Function OpenClipboard Lib "user32" (ByVal hwnd As LongPtr) As Long
Private Declare PtrSafe Function EmptyClipboard Lib "user32" () As Long
Private Declare PtrSafe Function CloseClipboard Lib "user32" () As Long
Private Declare PtrSafe Function SetClipboardData Lib "user32" (ByVal uFormat As Long, ByVal hMem As LongPtr) As LongPtr
Private Declare PtrSafe Function GlobalAlloc Lib "kernel32" (ByVal uFlags As Long, ByVal dwBytes As LongPtr) As LongPtr
Private Declare PtrSafe Function GlobalLock Lib "kernel32" (ByVal hMem As LongPtr) As LongPtr
Private Declare PtrSafe Function GlobalUnlock Lib "kernel32" (ByVal hMem As LongPtr) As Long
Private Declare PtrSafe Sub RtlMoveMemory Lib "kernel32" (ByVal dest As LongPtr, ByVal src As Any, ByVal Length As LongPtr)

Private Const GHND = &H42
Private Const CF_TEXT = 1

Sub CopyTextToClipboard(sText As String)
    Dim hGlobalMemory As LongPtr
    Dim lpGlobalMemory As LongPtr

    hGlobalMemory = GlobalAlloc(GHND, Len(sText) + 1)
    lpGlobalMemory = GlobalLock(hGlobalMemory)
    RtlMoveMemory lpGlobalMemory, ByVal sText, Len(sText) + 1
    GlobalUnlock hGlobalMemory
    OpenClipboard 0
    EmptyClipboard
    SetClipboardData CF_TEXT, hGlobalMemory
    CloseClipboard
End Sub

Sub GetSelectedCellsCoordinatesAndValues()
    Dim cell As Range
    Dim coordinates As String
    Dim selectedRange As Range

    ' Define the selected range
    Set selectedRange = Selection

    ' Loop through each cell in the selected range
    For Each cell In selectedRange
        If IsNumeric(cell.Value) And cell.Value <> "" Then
            If coordinates <> "" Then
                coordinates = coordinates
            End If
            coordinates = coordinates & (cell.Row - 1) & ", " & (cell.Column - 1) & ", " & cell.Value & "; "
        End If
    Next cell

    ' Copy the result to the clipboard
    CopyTextToClipboard coordinates

    MsgBox "Coordinates and values of selected cells copied to clipboard:" & vbCrLf & coordinates
End Sub

